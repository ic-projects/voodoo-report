\chapter{Design and Implementation}

Use \url{https://docs.google.com/document/d/1tCYCOFDeL8E3USIOunRNrqh6ekP_-kAQVHMrNJ4jk04} and the source code to complete. This section will probably need extensive, in-depth discussion of the algorithms we use, supported by diagrams for each part...

Should include discussion of technical challenges...

\section{Background}

\subsection{Architectural overview}

Diagram...

A full example query...

These are the components and their interactions...

Before vs after...

\subsection{Voodoo vector algebra}

This is what Voodoo is, how it works, and what it does (use \url{http://www.vldb.org/pvldb/vol9/p1707-pirk.pdf})...

Talk about existing architecture using monetdb and printer/planeater...

\subsection{Apache Calcite}

This is what Calcite is, how it works, and what it does (use \url{https://arxiv.org/pdf/1802.10233.pdf}, \url{https://calcite.apache.org/docs/}, \url{https://www.slideshare.net/JordanHalterman/introduction-to-apache-calcite})...

\subsection{SWIG}

This is what SWIG is, how it works, and what it does (I guess \url{http://www.swig.org/Doc1.3/Java.html}?)...

\subsection{LibClang}

This is what LibClang is, how it works, and what it does (I guess \url{https://clang.llvm.org/doxygen/group__CINDEX.html}?)...

\subsection{OpenCL}

This is what OpenCL is, how it works, and what it does...

(CUDA?)

\section{Generating Voodoo from SQL using Apache Calcite}

Description of what Apache Calcite gives us...

\subsection{Defining schemas and importing data}

We don't have an explicit storage manager / catalog, so we use byte buffers...

We have a SchemaFactory which...

We have a TableFactory which then ... based on supported types...

\subsection{Translating logical operators to Voodoo}

Description of overall algorithm to convert logical plan -> voodoo (rules)...

For each logical operator, description of logical plan -> voodoo...

Using enumerables for other things...

\subsection{Translating row expressions to Voodoo}

Description of overall algorithm to convert row expression -> voodoo (visitor)...

For each row expression, description of expr -> voodoo...

\subsection{Communicating with the Voodoo Kernel}

Printer implementation...

Discussion of SWIG API...

How we pass values in for ClangAST implementation...

How we get values back for ClangAST implementation...

Technical challenges to do with garbage collection etc....

\subsection{(Graphical web-interface)}

(Vue, buefy, blah blah blah)

\section{Generating OpenCL from Voodoo using LibClang}

\subsection{Using LibClang to generate AST components}

We considered these options, and chose LibClang because...

For each component, description of how it is represented...

\subsection{Translating Voodoo to a Clang AST}

Description of overall algorithm to convert voodoo -> clang ast...

For each Voodoo API function, description of what it does and algorithm to convert it to AST...

\subsection{Generating and running OpenCL code}

Alternatives to OpenCL...

Generating fragments...

Running fragments...

Getting results...
